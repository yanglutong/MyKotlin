package com.yang.mymedicalpoject.ui.activity;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;
import androidx.viewpager.widget.PagerAdapter;
import androidx.viewpager.widget.ViewPager;

import android.annotation.SuppressLint;
import android.content.Intent;
import android.os.Bundle;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.Gravity;
import android.view.View;
import android.view.ViewGroup;
import android.view.WindowManager;
import android.widget.PopupWindow;
import android.widget.RelativeLayout;
import android.widget.TextView;
import android.widget.Toast;

import com.example.mvplibrary.base.activity.BaseMvpActivity;
import com.example.mvplibrary.base.presenter.BasePresenterIml;
import com.yang.mymedicalpoject.R;
import com.yang.mymedicalpoject.bean.DaTiBean;
import com.yang.mymedicalpoject.constants.MyDaTiConstants;
import com.yang.mymedicalpoject.model.MyDaTiModel;
import com.yang.mymedicalpoject.register.presenter.MyDaTiPresenter;
import com.yang.mymedicalpoject.utils.MyTitleBar;
import com.yang.myregionselect.CommonPopupWindow;

import java.util.ArrayList;
import java.util.List;

public class DaTiActivity extends BaseMvpActivity<MyDaTiConstants.MyView, MyDaTiModel, MyDaTiPresenter> implements MyDaTiConstants.MyView, View.OnClickListener {

    private ViewPager mVp;
    private MyTitleBar titleBar;
    private ArrayList<View> views;
    private PagerAdapter adapter;
    private TextView tv_dati_card;
    private CommonPopupWindow window;
    @Override
    protected int createLayoutId() {
        return R.layout.activity_da_ti;
    }

    @Override
    protected void initMvpData() {
        find();
        //加载布局
        initLoad();
        //请求网络数据
        request();


    }

    private void initLoad() {
        views = new ArrayList<>();
    }

    @Override
    protected MyDaTiPresenter createPresenter() {
        return new MyDaTiPresenter();
    }

    private void request() {
        Intent intent = getIntent();
        String id = intent.getStringExtra("id");
        Log.i("杨路通", "DaTiActivityRequest: "+id);
        mPresenter.getData(id);
    }

    private void initData(List<DaTiBean.ListBean> list) {
        for (int i = 0; i <list.size() ; i++) {
            View view = View.inflate(DaTiActivity.this, R.layout.dati_item, null);;
            views.add(view);
        }
        adapter = new PagerAdapter() {
            public View currentView;
            @Override
            public int getCount() {
                return views.size();
            }
            public View getCurrentView(){
                return currentView;
            }
            @Override
            public boolean isViewFromObject(@NonNull View view, @NonNull Object object) {
                return view == object;
            }

            @Override
            public void setPrimaryItem(@NonNull ViewGroup container, int position, @NonNull Object object) {
                currentView= (View) object;
            }

            @NonNull
            @Override
            public Object instantiateItem(@NonNull ViewGroup container, int position) {
                TextView tv_type = views.get(position).findViewById(R.id.tv_type);
                //标题 关于粘连性肩关节囊炎,正确的选项有
                TextView tv_name = views.get(position).findViewById(R.id.tv_name);

                //A R
                RelativeLayout rl_1 = views.get(position).findViewById(R.id.rl_1);

                //A T
                TextView tv_11 = views.get(position).findViewById(R.id.tv_11);


                //

                //B R
                RelativeLayout rl_2 = views.get(position).findViewById(R.id.rl_2);

                //B T
                TextView tv_22 = views.get(position).findViewById(R.id.tv_22);

                //C
                RelativeLayout rl_3 = views.get(position).findViewById(R.id.rl_3);
                TextView tv_33 = views.get(position).findViewById(R.id.tv_33);
                //D
                RelativeLayout rl_4 = views.get(position).findViewById(R.id.rl_4);
                TextView tv_44 = views.get(position).findViewById(R.id.tv_44);


                TextView tv_1 = views.get(position).findViewById(R.id.tv_1);
                TextView tv_2 = views.get(position).findViewById(R.id.tv_2);
                TextView tv_3 = views.get(position).findViewById(R.id.tv_3);
                TextView tv_4 = views.get(position).findViewById(R.id.tv_4);



                tv_type.setText("单选题");

                tv_name.setText("\u3000\u3000\u3000\u3000"+list.get(position).getName());

                tv_1.setText(list.get(position).getData().getA());
                tv_2.setText(list.get(position).getData().getB());
                tv_3.setText(list.get(position).getData().getC());
                tv_4.setText(list.get(position).getData().getD());

                rl_1.setOnClickListener(new View.OnClickListener() {
                    @SuppressLint("ResourceAsColor")
                    @Override
                    public void onClick(View view) {